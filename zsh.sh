#!/bin/bash

# Install zsh, zsh-autosuggestions and zsh-syntax-highlighting
sudo apt update && sudo apt install -y zsh zsh-autosuggestions zsh-syntax-highlighting

# Set zsh as the default shell for the current user
chsh -s $(which zsh)

# Create a .zshrc file for the current user, if it does not exist
[ ! -f ~/.zshrc ] && touch ~/.zshrc

# Enable command history autocomplete
cat <<EOL >> ~/.zshrc
autoload -Uz up-line-or-beginning-search
autoload -Uz down-line-or-beginning-search
zle -N up-line-or-beginning-search
zle -N down-line-or-beginning-search
bindkey "^[[A" up-line-or-beginning-search
bindkey "^[[B" down-line-or-beginning-search
EOL

# Source zsh-autosuggestions and zsh-syntax-highlighting
echo "source /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh" >> ~/.zshrc
echo "source /usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" >> ~/.zshrc

# Set the working directory as the static prompt prefix
echo "export PS1=\"%d %% \"" >> ~/.zshrc

# Source the .zshrc file to apply changes immediately, if zsh is running
if [ "$SHELL" = "/usr/bin/zsh" ] || [ "$SHELL" = "/bin/zsh" ]; then
    source ~/.zshrc
fi
